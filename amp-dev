;
(self.AMP=self.AMP||[]).push({m:0,v:"2209142312000",n:"amp-mega-menu",ev:"0.1",l:!0,f:function(n,t){!function(){var t;function e(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function i(n,t){return(i=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n})(n,t)}function r(n){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}function a(n){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}function o(n,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return e(n)}var u="amp:dom-update",m="ArrowLeft";function f(n){return n?Array.prototype.slice.call(n):[]}Array.isArray;var c,s=Object.prototype;function l(n){return 1==(null==n?void 0:n.nodeType)}function h(n,t,e,i,r,a,o,u,m,f,c){return n}function d(n){return void 0!==c?c:c=function(n){try{var t=n.ownerDocument,e=t.createElement("div"),i=t.createElement("div");return e.appendChild(i),e.querySelector(":scope div")===i}catch(n){return!1}}(n)}function p(n,t){return n.replace(/^|,/g,"$&".concat(t," "))}function v(n,t){var e=n.classList,i="i-amphtml-scoped";e.add(i);var r=p(t,".".concat(i)),a=n.querySelectorAll(r);return e.remove(i),a}function b(n,t){if(d(n))return n.querySelector(p(t,":scope"));var e=v(n,t)[0];return void 0===e?null:e}function g(n,t,e){var i;for(i=n;i&&i!==e;i=i.parentElement)if(t(i))return i;return null}function y(n){var t=n.isConnected;if(void 0!==t)return t;for(var e=n;(e=w(e)).host;)e=e.host;return e.nodeType===Node.DOCUMENT_NODE}function w(n){if(Node.prototype.getRootNode)return n.getRootNode();var t,e;for(t=n;t.parentNode&&(!(e=t)||"I-AMPHTML-SHADOW-ROOT"!=e.tagName&&(11!=e.nodeType||"[object ShadowRoot]"!==Object.prototype.toString.call(e)));t=t.parentNode);return t}function x(n){try{n.focus()}catch(n){}}s.hasOwnProperty,s.toString;var k=[],A="__AMP_MODAL_SAVED_TAB_INDEX";function E(n){for(var t=[],e=n;e;e=e.parentNode||e.host)t.push(e);return t}function O(n,t,e){null===e||null==e?n.removeAttribute(t):n.setAttribute(t,e)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var j=self.__AMP_LOG;function R(n){return function(n,t){throw new Error("failed to call initLogConstructor")}()}function S(n,t,e,i,r,a,o,u,m,f,c){return n}function _(n){return n.nodeType?(e=n,t=(e.ownerDocument||e).defaultView,function(n,t){return M(n=function(n){return n.__AMP_TOP||(n.__AMP_TOP=n)}(n),"ampdoc")}(t)).getAmpDoc(n):n;var t,e}function M(n,t){S(D(n,t));var e=function(n){var t=n.__AMP_SERVICES;return t||(t=n.__AMP_SERVICES={}),t}(n)[t];return e.obj||(S(e.ctor),S(e.context),e.obj=new e.ctor(e.context),S(e.obj),e.context=null,e.resolve&&e.resolve(e.obj)),e.obj}function D(n,t){var e=n.__AMP_SERVICES&&n.__AMP_SERVICES[t];return!(!e||!e.ctor)}var L="amp-mega-menu",P=function(n){!function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),t&&i(n,t)}(S,n);var a,c,s=(a=S,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(n){return!1}}(),function(){var n,t=r(a);if(c){var e=r(this).constructor;n=Reflect.construct(t,arguments,e)}else n=t.apply(this,arguments);return o(this,n)});function S(n){var t;return(t=s.call(this,n)).DV=[],t.qV=0,t.FV=null,t.UV=null,t.Gl=t.win.document,t.XV=t.Gl.documentElement,t.Vs=null,t.PJ=n.id||Math.floor(100*Math.random()),t.GV=t.JV.bind(e(t)),t.KV=t.QV.bind(e(t)),t.ZV=t.nW.bind(e(t)),t}S.prerenderAllowed=function(){return!0};var P=S.prototype;return P.isLayoutSupported=function(n){return"fixed-height"===n},P.buildCallback=function(){var n,t,e,i,r;this.Vs=(n=this.element,t="action",e=_(n),D(r=(i=_(e)).isSingleDoc()?i.win:i,t)?M(r,t):null)},P.layoutCallback=function(){return this.JV(),this.element.addEventListener(u,this.GV),this.UV||(this.UV=this.eW()),t||(t=Promise.resolve(void 0))},P.unlayoutCallback=function(){return this.element.removeEventListener(u,this.GV),this.iW(),!0},P.eW=function(){var n=this.Gl.createElement("div");n.classList.add("i-amphtml-mega-menu-mask"),n.setAttribute("aria-hidden","true");var t,e=("header",((t=this.element).closest?t.closest("header"):g(t,(function(n){return function(n,t){var e=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return!!e&&e.call(n,"header")}(n)})))||this.element);return e.classList.add("i-amphtml-mega-menu-mask-parent"),e.appendChild(n),n},P.JV=function(){var n,t,e=this;this.DV=f((t="nav > * > li",d(n=this.element)?n.querySelectorAll(p(t,":scope")):v(n,t))),this.DV.filter((function(n){return!n.classList.contains("i-amphtml-mega-menu-item")})).forEach((function(n){if(1!=n.childElementCount){var t=b(n,"> button")||b(n,"> [role=button]"),i=b(n,"> [role=dialog]");a=t,o="".concat(L," requires each expandable item to include a button that toggles it."),(j.user||(j.user=R()),void j.user.win?j.userForEmbed||(j.userForEmbed=R()):j.user).assert(a,o,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined),e.rW(n,t,i)}else{var r=n.firstElementChild;e.rW(n,r,null)}var a,o}))},P.rW=function(n,t,e){var i=this;if(n.classList.add("i-amphtml-mega-menu-item"),this.qV++,t.classList.add("i-amphtml-mega-menu-heading"),t.hasAttribute("tabindex")||t.setAttribute("tabindex",0),t.addEventListener("click",(function(n){return i.aW(n)})),t.addEventListener("keydown",(function(n){return i.oW(n)})),e&&!this.Vs.hasAction(t,"tap",n)){e.classList.add("i-amphtml-mega-menu-content"),e.setAttribute("aria-modal","false");var r=e.getAttribute("id");r||(r=this.PJ+"_AMP_content_"+this.qV,e.setAttribute("id",r)),e.insertBefore(this.oY(),e.firstChild),e.appendChild(this.oY()),t.setAttribute("aria-haspopup","dialog"),t.setAttribute("aria-controls",r),t.setAttribute("aria-expanded","false")}},P.QV=function(n){var t=n.target;this.FV&&!this.FV.contains(t)&&y(t)&&this.iW()},P.nW=function(n){"Escape"===n.key&&this.iW()&&n.preventDefault()},P.aW=function(n){if(this.sX(n)){n.preventDefault(),n.stopPropagation();var t=n.currentTarget.parentElement;t!=this.iW()&&this.uW(t)}},P.sX=function(n){var t=n.target,e=n.currentTarget;return!g(t,(function(n){return"A"==n.tagName}),e)&&!this.Vs.hasAction(t,"tap",e)&&e.hasAttribute("aria-haspopup")},P.oW=function(n){if(!n.defaultPrevented)switch(n.key){case m:case"ArrowRight":return void this.mW(n);case"Enter":case" ":return void(n.target==n.currentTarget&&this.aW(n))}},P.mW=function(n){var t,e,i,r=n.currentTarget.parentElement,a=this.DV.indexOf(r);if(-1!==a){n.preventDefault();var o=n.key==m?-1:1;"rtl"==((i=this.Gl).body.getAttribute("dir")||i.documentElement.getAttribute("dir")||"ltr")&&(o=-o);var u=(t=a+o,e=this.DV.length,t>0&&e>0?t%e:(t%e+e)%e);x(this.fW(this.DV[u]))}},P.uW=function(n){var t=this;this.mutateElement((function(){var e=t.cW(n);(function(n){h(k.every((function(t){return t.element!==n}))),h(y(n));var t=function(n){for(var t=[],e=E(n),i=function(n){var i=e[n];if(!i.parentNode)return"continue";f(i.parentNode.children).filter((function(n){return n!=i})).forEach((function(n){return t.push(n)}))},r=0;r<e.length;r++)i(r);return t}(n),e=E(n).filter(l),i=function(n){for(var t=[],e=n;e;){var i=w(e),r=i.querySelectorAll(["a[href]","area[href]","button","details summary","iframe","input","select","textarea","[contenteditable]","[draggable]","[tabindex]"].join(","));Array.prototype.push.apply(t,r),e=i.host}return t}(n),r=i.filter((function(t){return n.contains(t)&&void 0!==t[A]})),a=i.filter((function(t){return!n.contains(t)&&void 0===t[A]})),o=t.concat(e).map((function(n){return{element:n,prevValue:n.getAttribute("aria-hidden")}}));e.forEach((function(n){return n.removeAttribute("aria-hidden")})),t.forEach((function(n){return n.setAttribute("aria-hidden","true")})),a.forEach((function(n){n[A]=n.getAttribute("tabindex"),n.setAttribute("tabindex","-1")})),r.forEach((function(n){h(void 0!==n[A]),O(n,"tabindex",n[A])})),k.push({element:n,hiddenElementInfos:o,focusableExternalElements:a,focusableInternalElements:r})})(e),e.setAttribute("aria-modal","true")})),n.setAttribute("open",""),this.element.setAttribute("open",""),this.UV.setAttribute("open",""),this.fW(n).setAttribute("aria-expanded","true"),x(n.querySelector(".i-amphtml-screen-reader")),this.XV.addEventListener("click",this.KV),this.XV.addEventListener("keydown",this.ZV),this.FV=n},P.iW=function(){var n=this;if(!this.FV)return null;var t=this.FV;this.mutateElement((function(){var e=n.cW(t);!function(n){var t=k.pop();h(t);var e=t.element,i=t.focusableExternalElements,r=t.focusableInternalElements,a=t.hiddenElementInfos;h(y(n)),h(e===n),a.forEach((function(n){return O(n.element,"aria-hidden",n.prevValue)})),r.forEach((function(n){return n.setAttribute("tabindex","-1")})),i.forEach((function(n){h(void 0!==n[A]),O(n,"tabindex",n[A]),n[A]=void 0}))}(e),e.setAttribute("aria-modal","false")})),t.removeAttribute("open"),this.element.removeAttribute("open"),this.UV.removeAttribute("open");var e=this.fW(t);return e.setAttribute("aria-expanded","false"),t.contains(this.Gl.activeElement)&&x(e),this.XV.removeEventListener("click",this.KV),this.XV.removeEventListener("keydown",this.ZV),this.FV=null,t},P.fW=function(n){return b(n,"> .i-amphtml-mega-menu-heading")},P.cW=function(n){return b(n,"> .i-amphtml-mega-menu-content")},P.oY=function(){var n=this,t=this.element.getAttribute("data-close-button-aria-label")||"Close the menu",e=this.Gl.createElement("button");return e.textContent=t,e.classList.add("i-amphtml-screen-reader"),e.addEventListener("click",(function(){return n.iW()})),e},S}(n.BaseElement);n.registerElement(L,P,"amp-mega-menu{z-index:1000!important;white-space:nowrap!important}amp-mega-menu.i-amphtml-layout-size-defined[open]{overflow:visible!important}amp-mega-menu nav{background:#fff}amp-mega-menu nav>*{margin:0}amp-mega-menu .i-amphtml-mega-menu-item{display:inline-block!important}amp-mega-menu .i-amphtml-mega-menu-heading{cursor:pointer!important}amp-mega-menu .i-amphtml-mega-menu-content{position:absolute;left:0;width:100vw;opacity:0!important;visibility:hidden!important;background:#fff}amp-mega-menu .i-amphtml-mega-menu-item[open]>.i-amphtml-mega-menu-content{visibility:visible!important;opacity:1!important}amp-mega-menu .i-amphtml-mega-menu-item:not([open]) .i-amphtml-screen-reader{display:none!important}.i-amphtml-mega-menu-mask-parent{z-index:1000!important;position:relative}.i-amphtml-mega-menu-mask{position:fixed!important;z-index:-1!important;visibility:hidden!important;opacity:0!important;top:0!important;bottom:0!important;left:0!important;right:0!important;background:rgba(0,0,0,0.5);transition:opacity 200ms,visibility 0s 200ms}.i-amphtml-mega-menu-mask[open]{opacity:1!important;visibility:visible!important;transition:opacity 200ms}\n/*# sourceURL=/extensions/amp-mega-menu/0.1/amp-mega-menu.css*/")}();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-mega-menu-0.1.js.map
